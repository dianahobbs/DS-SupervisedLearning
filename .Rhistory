#ungroup()%>%
dplyr::select(-c(mribmi_DIFF,BMI_Date,BIRTH))
rm(image)
# CDR - USERDATE has more data AND the dates are within a year of EXAMDATE !!*** USE USERDATE !!!!*****
##****first open in excel and format USERDATE and EXAMDATE as 3/14/2012 and THEN save to csv
CDR <- read.csv("./Data/ADNI/CDR.csv")%>%
mutate(CDR_Date = as.Date(USERDATE, "%m/%d/%Y"))%>%
replace_with_na(replace=list(CDGLOBAL=c(-1)))%>%
mutate(CDR = case_when(CDGLOBAL == "0" ~ "0", CDGLOBAL>0 ~ "1"))%>%
filter(VISCODE2 != 'f')%>%
dplyr::select(RID,CDR_Date,VISCODE2,CDR)
# MMSE ***first open in excel and format USERDATE as 3/14/2012 and THEN save to csv
MMSE <- read.csv("./Data/ADNI/MMSE.csv")%>%
mutate(MMSE_Date = as.Date(USERDATE, "%m/%d/%Y"))%>%
filter(VISCODE2 != 'f')%>%
replace_with_na(replace=list(MMSCORE=c(-1)))%>%
rename(MMSE=MMSCORE)%>%
select(RID,MMSE_Date,VISCODE2,MMSE)
cog <- merge(CDR,MMSE,by=c("RID","VISCODE2"))%>%
mutate(cdrmmse_DIFF = abs(as.numeric(difftime(MMSE_Date,CDR_Date, unit="weeks"))/52.25))%>%
filter(between(cdrmmse_DIFF, 0, 1))%>%
dplyr::select(-c(cdrmmse_DIFF,MMSE_Date))
rm(CDR,MMSE)
data <- merge(data,cog,by=c("RID","VISCODE2"),all=F)%>%
group_by(RID)%>% # Grouping by ID & keeping only distinct CDR visits for each participant
distinct(CDR_Date, .keep_all = T)%>%
ungroup()
rm(cog)
View(data)
# Title: OASIS Cohort Organization for Data Science Project
# Cleaning
# Author: Diana Hobbs
# Date: April 2022
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
# Functions to set up environment
rm(list=ls()) #removes all variables from the current environment
options(scipen = 999) #forces R not to use scientific notation
###### Load data and select columns of interest ######
###### OASIS Cohort Organization ######
# demographics/clinical/genetic/cognitive
demo <- read.csv("./Data/OASIS/Demog.csv")%>%
group_by(Subject)%>%
fill(height, .direction="down")%>%
fill(height, .direction="up")%>%
# APOE: 0=non-carrier of e4 allele, 1=carrier of e4 allele
mutate(APOE4 = str_replace_all(apoe,c("22"="0", "33"="0", "23"="0", "32"="0",
"24"="1", "42"="1",
"34"="1", "43"="1", "44"="1")),
RACE = str_replace_all(Race,c("Asian"="non-White","African American"="non-White","Caucasian"="White")),
BMI = (weight/(height^2)*703))%>%
mutate(cdr = case_when(cdr == 0 ~ "0",
cdr>0 ~ "1"))%>%
rename(SEX=M.F, Dx=dx1, MMSE=mmse, CDR=cdr, AGE=Age, EDUC=Education)%>%
dplyr::select(Label, Subject, AGE, SEX, EDUC, RACE, BMI, APOE4, MMSE, CDR)%>%
na.omit()
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")%>%
rename(ICV=IntraCranialVol)%>%
mutate(tothipp = Right.Hippocampus_volume + Left.Hippocampus_volume,
percenthipp = ((tothipp*100)/ICV),
thick = ((((lh_entorhinal_thickness + rh_entorhinal_thickness)+
(lh_fusiform_thickness + rh_fusiform_thickness)+
(lh_inferiortemporal_thickness + rh_inferiortemporal_thickness)+
(lh_middletemporal_thickness + rh_middletemporal_thickness))/8)))%>%
dplyr::select(Label,Subject,tothipp,percenthipp,ICV,thick)
## pet - Amyloid Positivity 21.9 cutoff
centiloid <- read.csv("./Data/OASIS/Centiloid.csv")%>%
rename(centiloid = Centil_fSUVR_TOT_CORTMEAN,
Label = MRId)%>%
mutate(AmyPositivity = case_when(centiloid >= 21.9 ~ "A+",
centiloid < 21.9 ~ "A-"))%>%
dplyr::select(-Centil_fSUVR_rsf_TOT_CORTMEAN)
image <- merge(mri,centiloid,by="Label")
data <- merge(demo,image,by=c("Subject","Label"))
rm(centiloid,demo,image,mri)
View(data)
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")
View(mri)
data$Label <- substring(data$Label, nchar(as.character(data$Label)) - 3)
data$Label <- as.numeric(data$Label)
data <- data%>%
mutate(followup = Label/365.5)
View(data)
data <- data%>%
mutate(followup = Label/365.5)%>%
filter(followup < 1)
View(data)
test<-as.data.frame(table(data$ID))
View(test)
View(data)
test<-as.data.frame(table(data$Subject))
View(test)
View(data)
# Title: OASIS Cohort Organization for Data Science Project
# Cleaning
# Author: Diana Hobbs
# Date: April 2022
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
# Functions to set up environment
rm(list=ls()) #removes all variables from the current environment
options(scipen = 999) #forces R not to use scientific notation
###### Load data and select columns of interest ######
###### OASIS Cohort Organization ######
# demographics/clinical/genetic/cognitive
demo <- read.csv("./Data/OASIS/Demog.csv")%>%
group_by(Subject)%>%
fill(height, .direction="down")%>%
fill(height, .direction="up")%>%
# APOE: 0=non-carrier of e4 allele, 1=carrier of e4 allele
mutate(APOE4 = str_replace_all(apoe,c("22"="0", "33"="0", "23"="0", "32"="0",
"24"="1", "42"="1",
"34"="1", "43"="1", "44"="1")),
RACE = str_replace_all(Race,c("Asian"="non-White","African American"="non-White","Caucasian"="White")),
BMI = (weight/(height^2)*703))%>%
mutate(cdr = case_when(cdr == 0 ~ "0",
cdr>0 ~ "1"))%>%
rename(SEX=M.F, Dx=dx1, MMSE=mmse, CDR=cdr, AGE=Age, EDUC=Education)%>%
dplyr::select(Label, Subject, AGE, SEX, EDUC, RACE, BMI, APOE4, MMSE, CDR)%>%
na.omit()
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")%>%
rename(ICV=IntraCranialVol)%>%
mutate(tothipp = Right.Hippocampus_volume + Left.Hippocampus_volume,
percenthipp = ((tothipp*100)/ICV),
thick = ((((lh_entorhinal_thickness + rh_entorhinal_thickness)+
(lh_fusiform_thickness + rh_fusiform_thickness)+
(lh_inferiortemporal_thickness + rh_inferiortemporal_thickness)+
(lh_middletemporal_thickness + rh_middletemporal_thickness))/8)))%>%
dplyr::select(Label,Subject,tothipp,percenthipp,ICV,thick)
## pet - Amyloid Positivity 21.9 cutoff
centiloid <- read.csv("./Data/OASIS/Centiloid.csv")%>%
rename(centiloid = Centil_fSUVR_TOT_CORTMEAN,
Label = MRId)%>%
mutate(AmyPositivity = case_when(centiloid >= 21.9 ~ "A+",
centiloid < 21.9 ~ "A-"))%>%
dplyr::select(-Centil_fSUVR_rsf_TOT_CORTMEAN)
image <- merge(mri,centiloid,by="Label")
data <- merge(demo,image,by=c("Subject","Label"))
rm(centiloid,demo,image,mri)
data$Label <- substring(data$Label, nchar(as.character(data$Label)) - 3)
data$Label <- as.numeric(data$Label)
data1 <- data%>%
data <- merge(demo,image,by=c("Subject","Label"))%>%
rename(RID=Subject)
# Title: OASIS Cohort Organization for Data Science Project
# Cleaning
# Author: Diana Hobbs
# Date: April 2022
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
# Functions to set up environment
rm(list=ls()) #removes all variables from the current environment
options(scipen = 999) #forces R not to use scientific notation
###### Load data and select columns of interest ######
###### OASIS Cohort Organization ######
# demographics/clinical/genetic/cognitive
demo <- read.csv("./Data/OASIS/Demog.csv")%>%
group_by(Subject)%>%
fill(height, .direction="down")%>%
fill(height, .direction="up")%>%
# APOE: 0=non-carrier of e4 allele, 1=carrier of e4 allele
mutate(APOE4 = str_replace_all(apoe,c("22"="0", "33"="0", "23"="0", "32"="0",
"24"="1", "42"="1",
"34"="1", "43"="1", "44"="1")),
RACE = str_replace_all(Race,c("Asian"="non-White","African American"="non-White","Caucasian"="White")),
BMI = (weight/(height^2)*703))%>%
mutate(cdr = case_when(cdr == 0 ~ "0",
cdr>0 ~ "1"))%>%
rename(SEX=M.F, Dx=dx1, MMSE=mmse, CDR=cdr, AGE=Age, EDUC=Education)%>%
dplyr::select(Label, Subject, AGE, SEX, EDUC, RACE, BMI, APOE4, MMSE, CDR)%>%
na.omit()
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")%>%
rename(ICV=IntraCranialVol)%>%
mutate(tothipp = Right.Hippocampus_volume + Left.Hippocampus_volume,
percenthipp = ((tothipp*100)/ICV),
thick = ((((lh_entorhinal_thickness + rh_entorhinal_thickness)+
(lh_fusiform_thickness + rh_fusiform_thickness)+
(lh_inferiortemporal_thickness + rh_inferiortemporal_thickness)+
(lh_middletemporal_thickness + rh_middletemporal_thickness))/8)))%>%
dplyr::select(Label,Subject,tothipp,percenthipp,ICV,thick)
## pet - Amyloid Positivity 21.9 cutoff
centiloid <- read.csv("./Data/OASIS/Centiloid.csv")%>%
rename(centiloid = Centil_fSUVR_TOT_CORTMEAN,
Label = MRId)%>%
mutate(AmyPositivity = case_when(centiloid >= 21.9 ~ "A+",
centiloid < 21.9 ~ "A-"))%>%
dplyr::select(-Centil_fSUVR_rsf_TOT_CORTMEAN)
image <- merge(mri,centiloid,by="Label")
data <- merge(demo,image,by=c("Subject","Label"))%>%
rename(RID=Subject)
rm(centiloid,demo,image,mri)
data$Label <- substring(data$Label, nchar(as.character(data$Label)) - 3)
data$Label <- as.numeric(data$Label)
data1 <- data%>%
mutate(followup = Label/365.5)%>%
group_by(RID)%>%
arrange(Label)%>%
filter(row_number()==1)%>%
ungroup()
View(data1)
test<-as.data.frame(table(data$RID))
data1 <- data%>%
mutate(followup = Label/365.5)%>%
group_by(RID)%>%
arrange(Label)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
# Title: OASIS Cohort Organization for Data Science Project
# Cleaning
# Author: Diana Hobbs
# Date: April 2022
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
# Functions to set up environment
rm(list=ls()) #removes all variables from the current environment
options(scipen = 999) #forces R not to use scientific notation
###### Load data and select columns of interest ######
###### OASIS Cohort Organization ######
# demographics/clinical/genetic/cognitive
demo <- read.csv("./Data/OASIS/Demog.csv")%>%
group_by(Subject)%>%
fill(height, .direction="down")%>%
fill(height, .direction="up")%>%
# APOE: 0=non-carrier of e4 allele, 1=carrier of e4 allele
mutate(APOE4 = str_replace_all(apoe,c("22"="0", "33"="0", "23"="0", "32"="0",
"24"="1", "42"="1",
"34"="1", "43"="1", "44"="1")),
RACE = str_replace_all(Race,c("Asian"="non-White","African American"="non-White","Caucasian"="White")),
BMI = (weight/(height^2)*703))%>%
mutate(cdr = case_when(cdr == 0 ~ "0",
cdr>0 ~ "1"))%>%
rename(SEX=M.F, Dx=dx1, MMSE=mmse, CDR=cdr, AGE=Age, EDUC=Education)%>%
dplyr::select(Label, Subject, AGE, SEX, EDUC, RACE, BMI, APOE4, MMSE, CDR)%>%
na.omit()
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")%>%
rename(ICV=IntraCranialVol)%>%
mutate(tothipp = Right.Hippocampus_volume + Left.Hippocampus_volume,
percenthipp = ((tothipp*100)/ICV),
thick = ((((lh_entorhinal_thickness + rh_entorhinal_thickness)+
(lh_fusiform_thickness + rh_fusiform_thickness)+
(lh_inferiortemporal_thickness + rh_inferiortemporal_thickness)+
(lh_middletemporal_thickness + rh_middletemporal_thickness))/8)))%>%
dplyr::select(Label,Subject,tothipp,percenthipp,ICV,thick)
## pet - Amyloid Positivity 21.9 cutoff
centiloid <- read.csv("./Data/OASIS/Centiloid.csv")%>%
rename(centiloid = Centil_fSUVR_TOT_CORTMEAN,
Label = MRId)%>%
mutate(AmyPositivity = case_when(centiloid >= 21.9 ~ "A+",
centiloid < 21.9 ~ "A-"))%>%
dplyr::select(-Centil_fSUVR_rsf_TOT_CORTMEAN)
image <- merge(mri,centiloid,by="Label")
data <- merge(demo,image,by=c("Subject","Label"))%>%
rename(RID=Subject)
rm(centiloid,demo,image,mri)
data$Label <- substring(data$Label, nchar(as.character(data$Label)) - 3)
data$Label <- as.numeric(data$Label)
data <- data%>%
mutate(followup = Label/365.5)%>%
group_by(RID)%>%
arrange(Label)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
View(data)
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
View(data)
View(ADNI_data)
View(data)
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
View(ADNI_data)
View(OASIS_data)
View(ADNI_data)
View(OASIS_data)
View(ADNI_data)
View(OASIS_data)
View(ADNI_data)
View(OASIS_data)
View(ADNI_data)
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
View(ADNI_data)
View(OASIS_data)
View(OASIS_data)
View(OASIS_data)
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,tracer,centiloid,AmyPositivity,days_since_mri)
View(OASIS_data)
View(ADNI_data)
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,tracer,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
View(ADNI_data)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,unit="weeks"))/52.25))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,tracer,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,unit="weeks"))/52.25)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,tracer,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,unit="weeks"))/52.25)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,tracer,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,unit="weeks"))/52.25)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
View(ADNI_data)
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date)%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date))%>%
View(ADNI_data)
View(ADNI_data)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date)))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date)))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
View(ADNI_data)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,units = "days")))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=as.numeric(difftime(MR_Date,CDR_Date,units = "days")))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
View(OASIS_data)
View(ADNI_data)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=abs(as.numeric(difftime(MR_Date,CDR_Date,units = "days"))))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=abs(as.numeric(difftime(MR_Date,CDR_Date,units = "days"))))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
View(ADNI_data)
data <- rbind(OASIS_data,ADNI_data)
View(data)
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=abs(as.numeric(difftime(MR_Date,CDR_Date,units = "days"))))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
data <- rbind(OASIS_data,ADNI_data)
View(data)
View(OASIS_data)
OASIS_Base_data <- OASIS_data%>%
group_by(RID)%>%
arrange(days_since_mri)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
ADNI_Base_data <- ADNI_data%>%
group_by(RID)%>%
arrange(days_since_mri)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
View(OASIS_Base_data)
# Figure out which IDs in full dataset are in the full dataset
OASIS_Base_IDs <- as.data.frame(table(OASIS_Base_data$RID))
ADNI_Base_IDs <- as.data.frame(table(ADNI_Base_data$RID))
OASIS_data_KEEP <- OASIS_data[(OASIS_data$RID %in% OASIS_Base_IDs$Var1),]
ADNI_data_KEEP <- ADNI_data[(ADNI_data$RID %in% OASIS_Base_IDs$Var1),]
ADNI_data_KEEP <- ADNI_data[(ADNI_data$RID %in% ADNI_Base_IDs$Var1),]
View(OASIS_data_KEEP)
# Title: OASIS and ADNI Cohort Merge for Data Science Project
# Merging
# Author: Diana Hobbs
# Date: April 2022
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
###### Load data and Merge ######
source("OASIS_Setup.R")
source("ADNI_Setup.R")
# Organize the data
OASIS_data <- OASIS_data%>%
rename(days_since_mri=Label)%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
ADNI_data <- ADNI_data%>%
mutate(days_since_mri=abs(as.numeric(difftime(MR_Date,CDR_Date,units = "days"))))%>%
dplyr::select(RID,AGE,SEX,EDUC,RACE,BMI,APOE4,tothipp,percenthipp,ICV,thick,centiloid,AmyPositivity,CDR,MMSE,days_since_mri)
# Create a baseline dataset for each
OASIS_Base_data <- OASIS_data%>%
group_by(RID)%>%
arrange(days_since_mri)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
ADNI_Base_data <- ADNI_data%>%
group_by(RID)%>%
arrange(days_since_mri)%>%
filter(row_number()==1)%>%
ungroup()%>%
filter(CDR==0 & MMSE>=27)
# Figure out which IDs in full dataset are in the full dataset
OASIS_Base_IDs <- as.data.frame(table(OASIS_Base_data$RID))
ADNI_Base_IDs <- as.data.frame(table(ADNI_Base_data$RID))
OASIS_data_KEEP <- OASIS_data[(OASIS_data$RID %in% OASIS_Base_IDs$Var1),]
ADNI_data_KEEP <- ADNI_data[(ADNI_data$RID %in% ADNI_Base_IDs$Var1),]
###### Set Up ######
# Load packages
pacman::p_load(tidyverse,jtools,naniar,lubridate,janitor,zoo)
# Functions to set up environment
rm(list=ls()) #removes all variables from the current environment
options(scipen = 999) #forces R not to use scientific notation
###### OASIS Cohort Organization ######
# demographics/clinical/genetic/cognitive
demo <- read.csv("./Data/OASIS/Demog.csv")%>%
group_by(Subject)%>%
fill(height, .direction="down")%>%
fill(height, .direction="up")%>%
# APOE: 0=non-carrier of e4 allele, 1=carrier of e4 allele
mutate(APOE4 = str_replace_all(apoe,c("22"="0", "33"="0", "23"="0", "32"="0",
"24"="1", "42"="1",
"34"="1", "43"="1", "44"="1")),
RACE = str_replace_all(Race,c("Asian"="non-White","African American"="non-White","Caucasian"="White")),
SEX = str_replace_all(M.F,c("M"="Male","F"="Female")),
BMI = (weight/(height^2)*703))%>%
mutate(cdr = case_when(cdr == 0 ~ "0",
cdr>0 ~ "1"))%>%
rename(Dx=dx1, MMSE=mmse, CDR=cdr, AGE=Age, EDUC=Education)%>%
dplyr::select(Label, Subject, AGE, SEX, EDUC, RACE, BMI, APOE4, MMSE, CDR)%>%
na.omit()
## mri
mri <- read.csv("./Data/OASIS/MRI.csv")%>%
rename(ICV=IntraCranialVol)%>%
mutate(tothipp = Right.Hippocampus_volume + Left.Hippocampus_volume,
percenthipp = ((tothipp*100)/ICV),
thick = ((((lh_entorhinal_thickness + rh_entorhinal_thickness)+
(lh_fusiform_thickness + rh_fusiform_thickness)+
(lh_inferiortemporal_thickness + rh_inferiortemporal_thickness)+
(lh_middletemporal_thickness + rh_middletemporal_thickness))/8)))%>%
dplyr::select(Label,Subject,tothipp,percenthipp,ICV,thick)
## pet - Amyloid Positivity 21.9 cutoff
centiloid <- read.csv("./Data/OASIS/Centiloid.csv")%>%
rename(centiloid = Centil_fSUVR_TOT_CORTMEAN,
Label = MRId)%>%
mutate(AmyPositivity = case_when(centiloid >= 21.9 ~ "A+",
centiloid < 21.9 ~ "A-"))%>%
dplyr::select(-Centil_fSUVR_rsf_TOT_CORTMEAN)
image <- merge(mri,centiloid,by="Label")
data <- merge(demo,image,by=c("Subject","Label"))%>%
rename(RID=Subject)
rm(centiloid,demo,image,mri)
